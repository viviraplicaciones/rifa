<!DOCTYPE html><html lang="es" class="h-full bg-gray-100"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plataforma de Rifas</title><script src="https://cdn.tailwindcss.com"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet"><style>body {font-family: 'Roboto', sans-serif;}#sidebar {transition: width 0.3s;}#sidebar.collapsed {width: 4rem;}#sidebar:not(.collapsed) {width: 16rem;}#sidebar.collapsed .sidebar-text {display: none;}#sidebar.collapsed .sidebar-icon {margin: 0 auto;}.no-scrollbar::-webkit-scrollbar {display: none;}.no-scrollbar {-ms-overflow-style: none;scrollbar-width: none;}.modal {display: none;}.modal.flex {display: flex;}.view {display: none;}.view.active {display: block;}.status-disponible {background-color: white;color: #374151;border-color: #D1D5DB;}.status-apartado {background-color: #3B82F6;color: white;border-color: #3B82F6;}.status-revisando {background-color: #F59E0B;color: white;border-color: #F59E0B;}.status-pagado {background-color: #EF4444;color: white;border-color: #EF4444;}.numero-rifa-publico {transition: all 0.2s ease-in-out;transform: scale(1);}.numero-rifa-publico:hover:not(.ocupado):not(.seleccionado) {box-shadow: 0 4px 14px 0 rgba(0, 0, 0, 0.1);transform: scale(1.05);}.numero-rifa-publico.seleccionado {background-color: #2563EB;color: white;border-color: #2563EB;transform: scale(1.1);box-shadow: 0 4px 14px 0 rgba(59, 130, 246, 0.5);}.numero-rifa-publico.ocupado {background-color: #EF4444;color: white;border-color: #EF4444;opacity: 0.7;cursor: not-allowed;}.numero-rifa-publico.revisando {background-color: #F59E0B;color: white;border-color: #F59E0B;opacity: 0.7;cursor: not-allowed;}.switch-checkbox:checked {background-color: #10B981;}.switch-checkbox:checked+.switch-dot {transform: translateX(100%);}.slider-image {transition: opacity 1s ease-in-out;}</style></head><body class="h-full flex bg-gray-100"><aside id="sidebar" class="bg-emerald-700 text-emerald-100 flex flex-col h-full shadow-lg no-scrollbar overflow-y-auto"><div class="flex items-center justify-center p-4 h-16 shrink-0"><div class="w-10 h-10 rounded-full overflow-hidden sidebar-icon bg-emerald-900 flex-shrink-0"><img src="icono.jpg" alt="RifaPRO Logo" class="w-full h-full object-cover"></div><span class="sidebar-text text-2xl font-bold ml-3">RifaPRO</span></div><div class="hidden md:flex items-center justify-center my-2"><button id="toggle-sidebar" class="text-emerald-200 hover:text-white hover:bg-emerald-600 rounded-full p-2 focus:outline-none"><i class="fa-solid fa-bars fa-lg"></i></button></div><nav class="flex-1 p-4 space-y-2"><a href="#" class="flex items-center p-3 rounded-lg hover:bg-emerald-600 nav-link active" data-view="view-inicio"><i class="fa-solid fa-house fa-lg sidebar-icon"></i><span class="sidebar-text text-lg ml-4">Inicio</span></a><a href="#" class="flex items-center p-3 rounded-lg hover:bg-emerald-600 nav-link" data-view="view-comprar-numeros"><i class="fa-solid fa-table-cells fa-lg sidebar-icon"></i><span class="sidebar-text text-lg ml-4">Comprar N칰meros</span></a><a href="#" class="flex items-center p-3 rounded-lg hover:bg-emerald-600 nav-link" data-view="view-faq"><i class="fa-solid fa-circle-question fa-lg sidebar-icon"></i><span class="sidebar-text text-lg ml-4">Preguntas Frecuentes</span></a><div class="pt-4 mt-4 border-t border-emerald-600"><p class="sidebar-text text-xs uppercase text-emerald-300 px-3 mb-2">Admin</p><a href="#" class="flex items-center p-3 rounded-lg hover:bg-emerald-600 nav-link" data-view="view-rifas-pv"><i class="fa-solid fa-store fa-lg sidebar-icon"></i><span class="sidebar-text text-lg ml-4">Rifas (P. Venta)</span></a><a href="#" class="flex items-center p-3 rounded-lg hover:bg-emerald-600 nav-link" data-view="view-participantes"><i class="fa-solid fa-users fa-lg sidebar-icon"></i><span class="sidebar-text text-lg ml-4">Participantes</span></a><a href="#" class="flex items-center p-3 rounded-lg hover:bg-emerald-600 nav-link" data-view="view-analiticos"><i class="fa-solid fa-chart-line fa-lg sidebar-icon"></i><span class="sidebar-text text-lg ml-4">Anal칤ticos</span></a></div></nav></aside><button id="toggle-sidebar-mobile" class="md:hidden fixed top-4 left-4 z-20 p-2 bg-emerald-700 text-white rounded-md"><i class="fa-solid fa-bars"></i></button><main class="flex-1 flex flex-col h-full overflow-y-auto"><div id="view-inicio" class="view active p-6 md:p-12"><div class="max-w-6xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden"><div class="md:flex"><div id="image-slider" class="md:w-1/2 relative h-64 md:h-full overflow-hidden"><img class="slider-image h-full w-full object-cover absolute" src="01.jpg" alt="Imagen 1"><img class="slider-image h-full w-full object-cover absolute hidden" src="02.jpg" alt="Imagen 2"><img class="slider-image h-full w-full object-cover absolute hidden" src="03.jpg" alt="Imagen 3"><img class="slider-image h-full w-full object-cover absolute hidden" src="04.jpg" alt="Imagen 4"><img class="slider-image h-full w-full object-cover absolute hidden" src="05.jpg" alt="Imagen 5"></div><div class="md:w-1/2 p-8 md:p-12"><h1 class="text-3xl md:text-4xl font-bold text-gray-900">Mazda CX5 2025</h1><p class="mt-4 text-lg text-gray-600">G치nate el carro de tus sue침os. Este gran Mazda CX5 0 Kil칩metros modelo 2025 color blanco Perla. Jugar치 con las 3 칰ltimas cifras de la loter칤a de Medell칤n.</p><ul class="mt-6 space-y-3 text-gray-700"><li class="flex items-center"><span class="text-xl mr-3">游볞</span><span><strong>Primer lugar:</strong> Mazda CX5</span></li><li class="flex items-center"><span class="text-xl mr-3">游눯</span><span><strong>5 Millones</strong> con n칰mero invertido</span></li><li class="flex items-center"><span class="text-xl mr-3">游눶</span><span><strong>2 Millones</strong> al que m치s tickets compre</span></li></ul><p class="mt-6 text-lg font-semibold text-gray-800">Juega cuando lleguemos al 100% de los tickets por la <strong>Loter칤a de Medell칤n</strong></p><div class="mt-8"><button id="btn-mas-info" class="w-full bg-emerald-600 text-white font-bold text-lg py-3 px-6 rounded-xl hover:bg-emerald-700 transition duration-300 shadow-lg">M치s Informaci칩n</button></div></div></div></div></div><div id="view-comprar-numeros" class="view p-4 md:p-6 lg:p-10"><div class="flex flex-col lg:flex-row gap-6 lg:gap-10"><div class="flex-1 bg-white p-6 rounded-2xl shadow-xl"><div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4"><div class="flex flex-wrap gap-x-4 gap-y-2 text-sm text-gray-600"><span class="flex items-center"><span class="w-4 h-4 rounded-full bg-red-500 mr-2 border"></span>Reservado</span><span class="flex items-center"><span class="w-4 h-4 rounded-full bg-amber-500 mr-2 border"></span>En revisi칩n</span><span class="flex items-center"><span class="w-4 h-4 rounded-full bg-white border mr-2"></span>Disponible</span><span class="flex items-center"><span class="w-4 h-4 rounded-full bg-blue-600 mr-2 border"></span>Seleccionado</span></div><label for="ocultar-comprados" class="flex items-center cursor-pointer"><span class="mr-3 text-sm font-medium text-gray-700">Ocultar n칰meros ya comprados</span><div class="relative"><input type="checkbox" id="ocultar-comprados" class="sr-only switch-checkbox"><div class="w-10 h-6 bg-gray-300 rounded-full shadow-inner transition duration-300"></div><div class="switch-dot absolute w-4 h-4 bg-white rounded-full shadow left-1 top-1 transition duration-300"></div></div></label></div><div id="cuadricula-numeros-publica" class="grid grid-cols-5 sm:grid-cols-10 lg:grid-cols-10 gap-2 md:gap-3"></div></div><div class="w-full lg:w-96 bg-white p-6 rounded-2xl shadow-xl h-fit sticky top-10"><h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center justify-between">Tu Selecci칩n<span id="cantidad-seleccionada-badge" class="text-sm bg-blue-100 text-blue-800 font-medium px-3 py-1 rounded-full">0 n칰meros</span></h2><div id="numeros-seleccionados-lista" class="flex flex-wrap gap-2 mb-4 min-h-[40px] bg-gray-50 p-3 rounded-lg border"><span class="text-gray-500 text-sm">Selecciona tus n칰meros...</span></div><div class="space-y-3 mb-6 border-t pt-4"><div class="flex justify-between text-lg text-gray-600"><span>Subtotal:</span><span id="subtotal" class="font-medium text-gray-900">$ 0</span></div><div class="flex justify-between text-lg text-gray-600"><span>Precio por n칰mero:</span><span id="precio-numero" class="font-medium text-gray-900">$ 5.000</span></div></div><button id="btn-proceder-pago" class="w-full bg-purple-600 text-white font-bold text-lg py-3 px-6 rounded-xl hover:bg-purple-700 transition duration-300 shadow-lg disabled:bg-gray-400">Proceder al pago</button><p class="text-xs text-gray-500 mt-4 text-center"><i class="fa-solid fa-circle-info mr-1"></i>Selecciona los n칰meros que deseas comprar.</p></div></div></div><div id="view-rifas-pv" class="view p-6 md:p-10"><h1 class="text-3xl font-bold text-gray-800 mb-6">Punto de Venta (Admin)</h1><div class="bg-white p-6 rounded-2xl shadow-xl"><div class="flex flex-wrap gap-3 mb-6"><button class="filtro-btn-admin filtro-admin-activo" data-filtro="todos">Todos</button><button class="filtro-btn-admin" data-filtro="disponible">Disponibles</button><button class="filtro-btn-admin" data-filtro="apartado">Apartados</button><button class="filtro-btn-admin" data-filtro="revisando">Revisando</button><button class="filtro-btn-admin" data-filtro="pagado">Pagados</button></div><div id="cuadricula-numeros-admin" class="grid grid-cols-5 sm:grid-cols-10 lg:grid-cols-10 xl:grid-cols-12 gap-2"></div></div></div><div id="view-participantes" class="view p-6 md:p-10"><div class="flex justify-between items-center mb-6"><h1 class="text-3xl font-bold text-gray-800">Participantes</h1><button id="btn-registrar-venta-global" class="bg-emerald-600 text-white font-bold py-2 px-5 rounded-xl hover:bg-emerald-700 transition shadow-lg flex items-center"><i class="fa-solid fa-plus mr-2"></i>Registrar Venta</button></div><div class="bg-white rounded-2xl shadow-xl overflow-hidden"><div class="overflow-x-auto"><table class="w-full"><thead class="bg-gray-50"><tr><th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">Nombre</th><th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">Tel칠fono</th><th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">N칰meros</th><th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">Estado</th></tr></thead><tbody id="tabla-participantes" class="divide-y divide-gray-200"><tr class="no-participantes"><td colspan="4" class="p-6 text-center text-gray-500">A칰n no hay participantes registrados.</td></tr></tbody></table></div></div></div><div id="view-analiticos" class="view p-6 md:p-10"><h1 class="text-3xl font-bold text-gray-800 mb-6">Anal칤ticos</h1><div class="bg-white p-10 rounded-2xl shadow-xl text-center"><i class="fa-solid fa-chart-line fa-3x text-emerald-500 mb-4"></i><h2 class="text-2xl font-semibold text-gray-700">Pr칩ximamente</h2><p class="text-gray-500 mt-2">Aqu칤 ver치s las estad칤sticas detalladas de tus rifas.</p></div></div><div id="view-faq" class="view p-6 md:p-12"><h1 class="text-3xl font-bold text-gray-800 mb-6">Preguntas Frecuentes (FAQ)</h1><div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-xl p-6 md:p-10"><div class="space-y-4"><div><h5 class="text-lg font-semibold text-gray-800">1. 쮼sto es real?</h5><p class="text-gray-600 mt-1">Esta es una rifa de demostraci칩n para mostrar el funcionamiento de la plataforma. El premio no ser치 entregado.</p></div><hr><div><h5 class="text-lg font-semibold text-gray-800">2. 쮺칩mo se eligen los ganadores?</h5><p class="text-gray-600 mt-1">De manera transparente, utilizando los n칰meros de la loter칤a nacional como referencia.</p></div><hr><div><h5 class="text-lg font-semibold text-gray-800">3. 쮻칩nde veo mis n칰meros?</h5><p class="text-gray-600 mt-1">Al finalizar la compra, recibir치s un correo (en un futuro) con el listado de tus n칰meros registrados.</p></div></div></div></div></main><div id="modal-mas-info" class="modal fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-60"><div class="relative p-4 w-full max-w-4xl mx-auto my-12"><div class="relative bg-white rounded-2xl shadow-2xl"><div class="flex justify-between items-center p-5 border-b rounded-t-2xl"><h3 class="text-2xl font-semibold text-gray-900">Informaci칩n de la Rifa</h3><button type="button" class="modal-close text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-2 ml-auto inline-flex items-center" data-modal-id="modal-mas-info"><i class="fa-solid fa-xmark fa-2x"></i><span class="sr-only">Cerrar modal</span></button></div><div class="p-6 md:p-8 space-y-6 max-h-[70vh] overflow-y-auto"><div class="flex flex-col md:flex-row gap-6"><img class="w-full md:w-1/3 h-auto object-cover rounded-lg" src="https://placehold.co/400x300/E2E8F0/334155?text=Mazda" alt="Detalle premio"><div class="flex-1"><h4 class="text-xl font-bold text-gray-800 mb-2">Detalles del premio</h4><ul class="list-disc list-inside text-gray-600 space-y-1"><li><strong>Modelo:</strong> Mazda CX-5</li><li><strong>A침o:</strong> 2025</li><li><strong>Color:</strong> Blanco perla</li><li><strong>Condici칩n:</strong> 0 Kil칩metros, totalmente nuevo</li><li><strong>Valor comercial:</strong> $150.000.000 COP (Aprox)</li></ul><p class="text-sm text-red-600 mt-3 font-medium"><i class="fa-solid fa-triangle-exclamation mr-1"></i>Importante: Esta rifa es solo de demostraci칩n, no se entregar치 un veh칤culo real.</p></div></div><hr><div><h4 class="text-xl font-bold text-gray-800 mb-3">Fechas</h4><ul class="list-disc list-inside text-gray-600 space-y-1"><li><strong>Inicio de la rifa:</strong> 25 de octubre de 2025</li><li><strong>Cierre de la rifa:</strong> 15 de diciembre de 2025</li><li><strong>Sorteo:</strong> 16 de diciembre de 2025</li></ul></div><hr><div><h4 class="text-xl font-bold text-gray-800 mb-3">쮺칩mo participar?</h4><ol class="list-decimal list-inside text-gray-600 space-y-2"><li>Elige tus n칰meros disponibles en la pantalla "Comprar N칰meros".</li><li>Realiza el pago (Subtotal).</li><li>Guarda tu comprobante y espera la confirmaci칩n (tu n칰mero pasar치 de 'revisando' a 'pagado').</li></ol></div></div></div></div></div><div id="modal-registrar-venta" class="modal fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-60"><div class="relative p-4 w-full max-w-lg mx-auto my-12"><div class="relative bg-white rounded-2xl shadow-2xl"><div class="flex justify-between items-center p-5 border-b rounded-t-2xl"><h3 class="text-2xl font-semibold text-gray-900">Registrar Venta Manual</h3><button type="button" class="modal-close text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-2 ml-auto inline-flex items-center" data-modal-id="modal-registrar-venta"><i class="fa-solid fa-xmark fa-2x"></i><span class="sr-only">Cerrar modal</span></button></div><form id="form-registrar-venta" class="p-6 md:p-8 space-y-6"><div><h4 class="text-lg font-semibold text-gray-800 mb-3">N칰meros a Registrar</h4><div id="lista-numeros-disponibles-modal" class="text-sm text-gray-500 mb-3">Cargando n칰meros disponibles...</div><div id="campos-numeros-dinamicos" class="space-y-3"></div><button type="button" id="btn-anadir-numero" class="mt-3 text-sm text-emerald-600 font-medium hover:text-emerald-800"><i class="fa-solid fa-plus mr-1"></i> A침adir otro n칰mero</button></div><div><h4 class="text-lg font-semibold text-gray-800 mb-3">Participante</h4><div class="space-y-4"><div><input type="text" id="participante-nombre" class="w-full p-3 border border-gray-300 rounded-lg text-gray-900" placeholder="Nombre y apellido" required></div><div><input type="tel" id="participante-telefono" class="w-full p-3 border border-gray-300 rounded-lg text-gray-900" placeholder="Tel칠fono" required></div><div><label for="participante-estado" class="block mb-2 text-sm font-medium text-gray-700">Estado del boleto</label><select id="participante-estado" class="w-full p-3 border border-gray-300 rounded-lg text-gray-900 bg-white"><option value="apartado">Apartado (Azul)</option><option value="revisando">Revisando (Naranja)</option><option value="pagado">Pagado (Rojo)</option></select></div></div></div><div class="flex items-center justify-end space-x-4 pt-4 border-t"><button type="button" class="modal-close text-gray-700 bg-gray-100 hover:bg-gray-200 font-medium rounded-lg px-5 py-2.5" data-modal-id="modal-registrar-venta">Cancelar</button><button type="submit" class="text-white bg-emerald-600 hover:bg-emerald-700 font-medium rounded-lg px-6 py-2.5">Guardar Venta</button></div></form></div></div></div><div id="toast-notificacion" class="fixed top-5 right-5 z-50 hidden items-center w-full max-w-xs p-4 text-gray-500 bg-white rounded-lg shadow-lg" role="alert"><div class="inline-flex items-center justify-center flex-shrink-0 w-8 h-8 text-emerald-500 bg-emerald-100 rounded-lg"><i class="fa-solid fa-check"></i></div><div id="toast-mensaje" class="ml-3 text-sm font-normal"></div><button type="button" id="toast-close" class="ml-auto -mx-1.5 -my-1.5 bg-white text-gray-400 hover:text-gray-900 rounded-lg p-1.5 hover:bg-gray-100 inline-flex h-8 w-8" aria-label="Close"><span class="sr-only">Close</span><i class="fa-solid fa-xmark"></i></button></div><script type="module">let boletosRifa=[];let participantes=[];const PRECIO_BOLETO=5000;function inicializarBoletos(){boletosRifa=[];for(let i=0;i<100;i++){const numero=String(i).padStart(2,'0');boletosRifa.push({id:numero,numero:numero,estado:'disponible',participanteId:null});}boletosRifa[5].estado='apartado';boletosRifa[5].participanteId='p1';boletosRifa[10].estado='revisando';boletosRifa[10].participanteId='p2';boletosRifa[25].estado='pagado';boletosRifa[25].participanteId='p3';boletosRifa[49].estado='apartado';boletosRifa[49].participanteId='p1';participantes=[{id:'p1',nombre:'Carlos Desiderio',telefono:'3001234567',numeros:['05','49'],estado:'apartado'},{id:'p2',nombre:'Ana Mar칤a',telefono:'3009876543',numeros:['10'],estado:'revisando'},{id:'p3',nombre:'Pedro Pascal',telefono:'3005555555',numeros:['25'],estado:'pagado'},];}let sidebar;let toggleSidebarBtn;let toggleSidebarMobileBtn;let navLinks;let views;let toastEl;let toastMsg;let toastCloseBtn;let cuadriculaPublica;let numerosSeleccionadosPublica=[];let listaSeleccionPublica;let badgeCantidad;let subtotalEl;let precioNumeroEl;let btnProcederPago;let switchOcultarComprados;let cuadriculaAdmin;let filtrosAdminContainer;let tablaParticipantes;let btnRegistrarVentaGlobal;let modalRegistrarVenta;let formRegistrarVenta;let camposNumerosDinamicos;let btnAnadirNumero;let listaNumerosModal;let btnMasInfo;let modalMasInfo;let modalCloseBtns;let currentSlide=0;let slides;let slideCount=0;document.addEventListener('DOMContentLoaded',()=>{inicializarBoletos();cachearElementosDOM();registrarEventListeners();actualizarVistaActiva('view-inicio');renderCuadriculaPublica();renderCuadriculaAdmin('todos');renderTablaParticipantes();actualizarSeleccionPublica();if(precioNumeroEl){precioNumeroEl.textContent=`$ ${PRECIO_BOLETO.toLocaleString('es-CO')}`;};slides=document.querySelectorAll('.slider-image');slideCount=slides.length;if(slideCount>0){setInterval(()=>{slides[currentSlide].classList.add('hidden','opacity-0');currentSlide=(currentSlide+1)%slideCount;slides[currentSlide].classList.remove('hidden','opacity-0');},4000);}});function cachearElementosDOM(){sidebar=document.getElementById('sidebar');toggleSidebarBtn=document.getElementById('toggle-sidebar');toggleSidebarMobileBtn=document.getElementById('toggle-sidebar-mobile');navLinks=document.querySelectorAll('.nav-link');views=document.querySelectorAll('.view');toastEl=document.getElementById('toast-notificacion');toastMsg=document.getElementById('toast-mensaje');toastCloseBtn=document.getElementById('toast-close');cuadriculaPublica=document.getElementById('cuadricula-numeros-publica');listaSeleccionPublica=document.getElementById('numeros-seleccionados-lista');badgeCantidad=document.getElementById('cantidad-seleccionada-badge');subtotalEl=document.getElementById('subtotal');precioNumeroEl=document.getElementById('precio-numero');btnProcederPago=document.getElementById('btn-proceder-pago');switchOcultarComprados=document.getElementById('ocultar-comprados');cuadriculaAdmin=document.getElementById('cuadricula-numeros-admin');filtrosAdminContainer=document.querySelector('#view-rifas-pv .flex-wrap');tablaParticipantes=document.getElementById('tabla-participantes');btnRegistrarVentaGlobal=document.getElementById('btn-registrar-venta-global');modalRegistrarVenta=document.getElementById('modal-registrar-venta');formRegistrarVenta=document.getElementById('form-registrar-venta');camposNumerosDinamicos=document.getElementById('campos-numeros-dinamicos');btnAnadirNumero=document.getElementById('btn-anadir-numero');listaNumerosModal=document.getElementById('lista-numeros-disponibles-modal');btnMasInfo=document.getElementById('btn-mas-info');modalMasInfo=document.getElementById('modal-mas-info');modalCloseBtns=document.querySelectorAll('.modal-close');}function registrarEventListeners(){toggleSidebarBtn?.addEventListener('click',toggleSidebar);toggleSidebarMobileBtn?.addEventListener('click',toggleSidebarMobile);navLinks.forEach(link=>{link.addEventListener('click',(e)=>{e.preventDefault();const viewId=link.getAttribute('data-view');actualizarVistaActiva(viewId);if(window.innerWidth<768){sidebar?.classList.add('collapsed');}});});toastCloseBtn?.addEventListener('click',()=>toastEl.classList.add('hidden'));cuadriculaPublica?.addEventListener('click',handleSeleccionPublica);switchOcultarComprados?.addEventListener('change',renderCuadriculaPublica);btnProcederPago?.addEventListener('click',()=>{if(numerosSeleccionadosPublica.length>0){mostrarToast(`Simulaci칩n de pago para ${numerosSeleccionadosPublica.length} n칰meros.`);}else{mostrarToast("Por favor, selecciona al menos un n칰mero.",true);}});filtrosAdminContainer?.addEventListener('click',handleFiltroAdmin);btnRegistrarVentaGlobal?.addEventListener('click',()=>abrirModalRegistro());formRegistrarVenta?.addEventListener('submit',handleGuardarVenta);btnAnadirNumero?.addEventListener('click',()=>anadirCampoNumero(null));btnMasInfo?.addEventListener('click',()=>modalMasInfo.classList.add('flex'));modalCloseBtns.forEach(btn=>{btn.addEventListener('click',()=>{const modalId=btn.getAttribute('data-modal-id');document.getElementById(modalId)?.classList.remove('flex');});});window.addEventListener('click',(event)=>{if(event.target.classList.contains('modal')){event.target.classList.remove('flex');}});}function toggleSidebar(){sidebar?.classList.toggle('collapsed');}function toggleSidebarMobile(){sidebar?.classList.toggle('collapsed');}function actualizarVistaActiva(viewId){views.forEach(view=>{view.classList.remove('active');});document.getElementById(viewId)?.classList.add('active');navLinks.forEach(link=>{link.classList.remove('active','bg-emerald-600');if(link.getAttribute('data-view')===viewId){link.classList.add('active','bg-emerald-600');}});}function mostrarToast(mensaje,esError=false){if(!toastEl||!toastMsg)return;toastMsg.textContent=mensaje;const iconContainer=toastEl.querySelector('.inline-flex');const icon=iconContainer.querySelector('i');iconContainer.classList.remove('text-emerald-500','bg-emerald-100','text-red-500','bg-red-100');icon.classList.remove('fa-check','fa-triangle-exclamation');if(esError){iconContainer.classList.add('text-red-500','bg-red-100');icon.classList.add('fa-solid','fa-triangle-exclamation');}else{iconContainer.classList.add('text-emerald-500','bg-emerald-100');icon.classList.add('fa-solid','fa-check');}toastEl.classList.remove('hidden');setTimeout(()=>{toastEl.classList.add('hidden');},3000);}function renderCuadriculaPublica(){if(!cuadriculaPublica)return;const ocultar=switchOcultarComprados?.checked;cuadriculaPublica.innerHTML='';boletosRifa.forEach(boleto=>{let claseEstado='';let esOcupado=false;switch(boleto.estado){case'apartado':case'pagado':claseEstado='ocupado';esOcupado=true;break;case'revisando':claseEstado='revisando';esOcupado=true;break;case'disponible':default:claseEstado='';break;}if(ocultar&&esOcupado){return;}const esSeleccionado=numerosSeleccionadosPublica.includes(boleto.numero);if(esSeleccionado&&!esOcupado){claseEstado='seleccionado';}const divBoleto=document.createElement('div');divBoleto.className=`numero-rifa-publico w-full aspect-square flex items-center justify-center font-bold text-lg border-2 rounded-xl cursor-pointer ${claseEstado}`;divBoleto.textContent=boleto.numero;divBoleto.dataset.numero=boleto.numero;divBoleto.dataset.estado=boleto.estado;cuadriculaPublica.appendChild(divBoleto);});}function handleSeleccionPublica(e){const boletoEl=e.target.closest('.numero-rifa-publico');if(!boletoEl)return;const numero=boletoEl.dataset.numero;const estado=boletoEl.dataset.estado;if(estado!=='disponible'){mostrarToast("Este n칰mero no est치 disponible.",true);return;}const index=numerosSeleccionadosPublica.indexOf(numero);if(index>-1){numerosSeleccionadosPublica.splice(index,1);}else{numerosSeleccionadosPublica.push(numero);}renderCuadriculaPublica();actualizarSeleccionPublica();}function actualizarSeleccionPublica(){if(!listaSeleccionPublica||!badgeCantidad||!subtotalEl||!btnProcederPago)return;const cantidad=numerosSeleccionadosPublica.length;listaSeleccionPublica.innerHTML='';if(cantidad===0){listaSeleccionPublica.innerHTML='<span class="text-gray-500 text-sm">Selecciona tus n칰meros...</span>';btnProcederPago.disabled=true;}else{numerosSeleccionadosPublica.sort().forEach(numero=>{const tiquet=document.createElement('span');tiquet.className="bg-blue-600 text-white text-sm font-bold px-3 py-1 rounded-md";tiquet.textContent=numero;listaSeleccionPublica.appendChild(tiquet);});btnProcederPago.disabled=false;}badgeCantidad.textContent=`${cantidad} n칰meros`;subtotalEl.textContent=`$ ${(cantidad*PRECIO_BOLETO).toLocaleString('es-CO')}`;}function renderCuadriculaAdmin(filtro){if(!cuadriculaAdmin)return;cuadriculaAdmin.innerHTML='';const boletosFiltrados=boletosRifa.filter(boleto=>{if(filtro==='todos')return true;return boleto.estado===filtro;});boletosFiltrados.forEach(boleto=>{let claseColor='status-disponible';switch(boleto.estado){case'apartado':claseColor='status-apartado';break;case'revisando':claseColor='status-revisando';break;case'pagado':claseColor='status-pagado';break;}const divBoleto=document.createElement('div');divBoleto.className=`w-full aspect-square flex items-center justify-center font-medium text-sm border rounded-md ${claseColor}`;divBoleto.textContent=boleto.numero;cuadriculaAdmin.appendChild(divBoleto);});}function handleFiltroAdmin(e){if(e.target.tagName!=='BUTTON')return;const filtro=e.target.dataset.filtro;filtrosAdminContainer.querySelectorAll('.filtro-btn-admin').forEach(btn=>{btn.classList.remove('filtro-admin-activo');});e.target.classList.add('filtro-admin-activo');renderCuadriculaAdmin(filtro);}function renderTablaParticipantes(){if(!tablaParticipantes)return;tablaParticipantes.innerHTML='';if(participantes.length===0){tablaParticipantes.innerHTML=`
<tr class="no-participantes"><td colspan="4" class="p-6 text-center text-gray-500">A칰n no hay participantes registrados.</td></tr>`;return;}participantes.forEach(p=>{let colorEstado='text-gray-700';switch(p.estado){case'apartado':colorEstado='text-blue-600 font-medium';break;case'revisando':colorEstado='text-amber-600 font-medium';break;case'pagado':colorEstado='text-red-600 font-medium';break;}const fila=document.createElement('tr');fila.innerHTML=`
<td class="p-4 text-sm text-gray-800">${p.nombre}</td>
<td class="p-4 text-sm text-gray-600">${p.telefono}</td>
<td class="p-4 text-sm text-gray-600">${p.numeros.join(', ')}</td>
<td class="p-4 text-sm ${colorEstado}">${p.estado.charAt(0).toUpperCase()+p.estado.slice(1)}</td>`;tablaParticipantes.appendChild(fila);});}function abrirModalRegistro(){if(!modalRegistrarVenta||!formRegistrarVenta||!camposNumerosDinamicos)return;formRegistrarVenta.reset();camposNumerosDinamicos.innerHTML='';actualizarListaDisponiblesModal();anadirCampoNumero(null);modalRegistrarVenta.classList.add('flex');}function getNumerosDisponibles(){return boletosRifa.filter(b=>b.estado==='disponible').map(b=>b.numero);}function actualizarListaDisponiblesModal(){if(!listaNumerosModal)return;const disponibles=getNumerosDisponibles();if(disponibles.length>0){listaNumerosModal.textContent=`Disponibles: ${disponibles.join(', ')}`;}else{listaNumerosModal.textContent='춰No quedan n칰meros disponibles!';}}function anadirCampoNumero(numeroSeleccionado){if(!camposNumerosDinamicos)return;const numerosYaSeleccionadosEnModal=Array.from(camposNumerosDinamicos.querySelectorAll('select')).map(select=>select.value).filter(val=>val!=='');const numerosDisponibles=getNumerosDisponibles().filter(num=>!numerosYaSeleccionadosEnModal.includes(num)||num===numeroSeleccionado);const divCampo=document.createElement('div');divCampo.className='flex items-center gap-2';const select=document.createElement('select');select.className='w-full p-3 border border-gray-300 rounded-lg text-gray-900 bg-white select-numero-dinamico';select.required=true;let optionsHTML='<option value="" disabled>Selecciona un n칰mero</option>';if(numeroSeleccionado){optionsHTML+=`<option value="${numeroSeleccionado}" selected>${numeroSeleccionado}</option>`;}numerosDisponibles.forEach(num=>{optionsHTML+=`<option value="${num}">${num}</option>`;});select.innerHTML=optionsHTML;if(!numeroSeleccionado){select.value="";}select.addEventListener('change',()=>{actualizarSelectsDinamicos();});const btnEliminar=document.createElement('button');btnEliminar.type='button';btnEliminar.className='text-red-500 hover:text-red-700 p-2';btnEliminar.innerHTML='<i class="fa-solid fa-trash"></i>';btnEliminar.onclick=()=>{divCampo.remove();actualizarSelectsDinamicos();};divCampo.appendChild(select);divCampo.appendChild(btnEliminar);camposNumerosDinamicos.appendChild(divCampo);}function actualizarSelectsDinamicos(){if(!camposNumerosDinamicos)return;const selects=camposNumerosDinamicos.querySelectorAll('.select-numero-dinamico');const valoresSeleccionados=Array.from(selects).map(s=>s.value).filter(v=>v!=='');const numerosDisponibles=getNumerosDisponibles();selects.forEach(select=>{const valorActual=select.value;let optionsHTML='<option value="" disabled>Selecciona un n칰mero</option>';if(valorActual){optionsHTML+=`<option value="${valorActual}" selected>${valorActual}</option>`;}numerosDisponibles.forEach(num=>{if(!valoresSeleccionados.includes(num)||num===valorActual){if(num!==valorActual){optionsHTML+=`<option value="${num}">${num}</option>`;}}});select.innerHTML=optionsHTML;select.value=valorActual;});}function handleGuardarVenta(e){e.preventDefault();if(!formRegistrarVenta)return;const nombre=document.getElementById('participante-nombre').value;const telefono=document.getElementById('participante-telefono').value;const estado=document.getElementById('participante-estado').value;const selectsNumeros=camposNumerosDinamicos.querySelectorAll('select');const numerosSeleccionados=Array.from(selectsNumeros).map(select=>select.value).filter(value=>value!=='');if(numerosSeleccionados.length===0){mostrarToast("Debes seleccionar al menos un n칰mero.",true);return;}const nuevoParticipante={id:`p${participantes.length+1}`,nombre:nombre,telefono:telefono,numeros:numerosSeleccionados,estado:estado};participantes.push(nuevoParticipante);numerosSeleccionados.forEach(numero=>{const boleto=boletosRifa.find(b=>b.numero===numero);if(boleto){boleto.estado=estado;boleto.participanteId=nuevoParticipante.id;}});renderTablaParticipantes();renderCuadriculaAdmin('todos');renderCuadriculaPublica();actualizarSeleccionPublica();modalRegistrarVenta.classList.remove('flex');mostrarToast("춰Venta registrada con 칠xito!");filtrosAdminContainer.querySelectorAll('.filtro-btn-admin').forEach(btn=>{btn.classList.remove('filtro-admin-activo');});document.querySelector('.filtro-btn-admin[data-filtro="todos"]').classList.add('filtro-admin-activo');}const style=document.createElement('style');style.innerHTML=`
.filtro-btn-admin {padding: 0.5rem 1.25rem;border-radius: 0.75rem;font-weight: 600;transition: all 0.2s;border: 2px solid transparent;}.filtro-btn-admin[data-filtro="todos"] { border-color: #6B7280; color: #374151; }.filtro-btn-admin[data-filtro="disponible"] { border-color: #D1D5DB; color: #374151; }.filtro-btn-admin[data-filtro="apartado"] { border-color: #3B82F6; color: #3B82F6; }.filtro-btn-admin[data-filtro="revisando"] { border-color: #F59E0B; color: #F59E0B; }.filtro-btn-admin[data-filtro="pagado"] { border-color: #EF4444; color: #EF4444; }.filtro-btn-admin.filtro-admin-activo, .filtro-btn-admin:hover {color: white !important;}.filtro-btn-admin.filtro-admin-activo[data-filtro="todos"], .filtro-btn-admin:hover[data-filtro="todos"] { background-color: #6B7280; }.filtro-btn-admin.filtro-admin-activo[data-filtro="disponible"], .filtro-btn-admin:hover[data-filtro="disponible"] { background-color: #9CA3AF; }.filtro-btn-admin.filtro-admin-activo[data-filtro="apartado"], .filtro-btn-admin:hover[data-filtro="apartado"] { background-color: #3B82F6; }.filtro-btn-admin.filtro-admin-activo[data-filtro="revisando"], .filtro-btn-admin:hover[data-filtro="revisando"] { background-color: #F59E0B; }.filtro-btn-admin.filtro-admin-activo[data-filtro="pagado"], .filtro-btn-admin:hover[data-filtro="pagado"] { background-color: #EF4444; }`;document.head.appendChild(style);</script></body></html>